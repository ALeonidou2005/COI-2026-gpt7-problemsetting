# GPT-7
Ο κύριος Κόκος μόλις πήρε δουλειά στην *AnihtoAI* και του ανατέθηκε να δημιουργήσει ένα πειραματικό σύστημα παραγωγής εικόνων για το GPT-7.

Ο στόχος του συστήματος είναι να μετατρέπει πρόχειρα σκίτσα **K**×**K** pixels (που δίνουν οι χρήστες) σε επεξεργασμένες ρεαλιστικές εικόνες **K**×**K** pixels. Τόσο τα σκίτσα εισόδου όσο και οι επεξεργασμένες εικόνες εξόδου αναπαριστώνται ως δισδιάστατοι πίνακες **K**×**K** ακέραιων αριθμών.

<div align="center">
<img src="Images/gpt7_pipeline.png" width="400">
</div>

Για να δουλέψει το σύστημα, υπάρχουν **M επίπεδα μετασχηματισμού** (transformation layers), αριθμημένα από το **0** εώς το **M−1**, όπου κάθε επίπεδο, **Layer[i]**, αναπαριστάται από ένα δισδιάστατο πίνακα **K**×**K** ακέραιων αριθμών.

Το σύστημα παραγωγής εικόνων λειτουργεί ως εξής:

- Ένα σκίτσο δίνεται ως ένας **K**×**K** πίνακας, **InputMatrix**. Για να παραχθεί η τελική επεξεργασμένη εικόνα, που αναπαρίσταται ως ένας **K**×**K** πίνακας, **OutputMatrix**, το σύστημα επιλέγει ένα συνεχόμενο διάστημα επιπέδων μετασχηματισμού, από το **L** μέχρι το **R** (**0** ≤ **L** ≤ **R** < **M**), συμπεριλαμβανομένων των άκρων, και τα εφαρμόζει πάνω στο **InputMatrix** ως ένα άθροισμα με εναλλασσόμενα πρόσημα.

- Συγκεκριμένα,

    **OutputMatrix = InputMatrix + (Layer[L] - Layer[L+1] + Layer[L+2] - Layer[L+3] + ... ± Layer[R])**

- **Σημείωση:** Το πρώτο επίπεδο ( **Layer[L]** ) πάντα **προστίθεται**, και στη συνέχεια οι πράξεις **εναλλάσσονται μεταξύ αφαίρεσης και πρόσθεσης**.

<br>

### **Ορισμός Πρόσθεσης και Αφαίρεσης Πινάκων:**

Η πρόσθεση/αφαίρεση δύο πινάκων ιδίου μεγέθους ορίζεται στοιχείο προς στοιχείο. 
Παράδειγμα πρόσθεσης **2**×**2** πίνακα:

<img src="Images/matrix_addition_latex.png" width="400">

<div style="page-break-after: always;"></div>

### **Το Ζητούμενο**

Ο κύριος Κόκος χρειάζεται τη βοήθειά σας για να ελέγξει το σύστημα που δημιούργησε.

Δίνoνται,
- **M** πίνακες αριθμημένοι από το **0** εώς το **Μ-1** (τα επίπεδα μετασχηματισμού του συστήματος).
- **N** πίνακες αριθμημένοι από το **0** εώς το **Ν-1** (τα σκίτσα), και για κάθε πίνακα δίνονται δύο ακέραιοι αριθμοί **L** και **R** (οι παράμετροι του σκίτσου).
- Ένας πίνακας που αναπαριστά την επιθυμητή επεξεργασμένη εικόνα, **TargetMatrix**.

Για κάθε σκίτσο, **InputMatrix[i]**, πρώτα υπολογίστε την αντίστοιχη επεξεργασμένη εικόνα, **OutputMatrix[i]**, όπως περιγράφεται πιο πάνω. Έπειτα ορίζουμε το **σφάλμα (error)** ενός σκίτσου, **Error[i]**, ως το άθροισμα των τετραγώνων διαφορών ανά θέση μεταξύ του **OutputMatrix[i]** και του **TargetMatrix**:
 
<img src="Images/error_latex.png" width="500">

Να βρείτε **ποιο σκίτσο έχει το μικρότερο σφάλμα**. Αν υπάρχουν περισσότερα από ένα σκίτσα με το μικρότερο σφάλμα, επιλέξτε αυτό με την μικρότερο θέση (το σκίτσο που δόθηκε πρώτο στα δεδομένα εισόδου).

## **Δεδομένα Εισόδου**

<hr style="border: 0; border-top: 0.1px solid #ddd;">

- Η πρώτη γραμμή περιέχει τρεις ακέραιους αριθμούς **N, M,** και **K**.
- Στις επόμενες **M**×**K** γραμμές, δίνονται **M** πίνακες **K**×**K**, αριθμημένοι από το **0** εώς το **Μ-1**, που αναπαριστούν τα επίπεδα μετασχηματισμού του συστήματος.
- Στις επόμενες **N**×(**K**+**1**) γραμμές, δίνονται **N** σκίτσα, αριθμημένα από το **0** εώς το **Ν-1**, όπου κάθε σκίτσο αποτελείται από:
  - Μία γραμμή με τις παραμέτρους **L** και **R** του σκίτσου.
  - Ένα πίνακα **K**×**K** που αναπαριστά το **InputMatrix** του σκίτσου.
- Στις επόμενες **K** γραμμές, δίνεται ένας πίνακας **K×K** που αναπαριστά την επιθυμητή επεξεργασμένη εικόνα, **TargetMatrix**.

**Σημείωση:** Κάθε πίνακας K×K στα δεδομένα εισόδου αποτελείται από **K** γραμμές, με **K** ακέραιους αριθμούς σε κάθε γραμμή. Ο j-οστός αριθμός στην i-οστή γραμμή αντιστοιχεί στο στοιχείο (i, j) του πίνακα.

## **Δεδομένα Εξόδου**

<hr style="border: 0; border-top: 0.1px solid #ddd;">

Εκτυπώστε δύο ακέραιους αριθμούς:
1. Την **(0-based) θέση** του σκίτσου με το **ελάχιστο σφάλμα**.
2. Την τιμή του αντίστοιχου **ελάχιστου σφάλματος**.

<div style="page-break-after: always;"></div>

## **Περιορισμοί**

- 1 ≤ N ≤ 10<sup>5</sup>
- 1 ≤ M ≤ 10<sup>5</sup>
- 1 ≤ K ≤ 10
- Για κάθε στοιχείο των πινάκων ισχύει ότι η απόλυτη τιμή του **δεν ξεπερνά το 10<sup>3</sup>**

## **Υποπροβλήματα**

- **Υποπρόβλημα 1 (5 βαθμοί):** N = 1, M ≤ 100, K = 1
- **Υποπρόβλημα 2 (5 βαθμοί):** N = 1, M = 1, K ≤ 10
- **Υποπρόβλημα 3 (25 βαθμοί):** N ≤ 10<sup>3</sup>, M ≤ 10<sup>3</sup>, K ≤ 10
- **Υποπρόβλημα 4 (20 βαθμοί):** N ≤ 10<sup>5</sup>, M ≤ 10<sup>5</sup>, K = 1, L = 0 για όλα τα σκίτσα
- **Υποπρόβλημα 5 (30 βαθμοί):** N ≤ 10<sup>5</sup>, M ≤ 10<sup>5</sup>, K = 1
- **Υποπρόβλημα 6 (15 βαθμοί):** N ≤ 10<sup>5</sup>, M ≤ 10<sup>5</sup>, K ≤ 10

## **Παράδειγμα**

### **Παράδειγμα Εισόδου**

```txt
2 3 2

1 4
7 0

3 2
5 1

0 6
2 8

0 2
2 1
0 2

1 1
3 3
2 9

4 5
6 7
```
**Σημείωση:** 
Οι κενές γραμμές στο παράδειγμα εισόδου προστέθηκαν μόνο για λόγους ευκρίνειας. Στα πραγματικά δεδομένα εισόδου δεν υπάρχουν κενές γραμμές.

<div style="page-break-after: always;"></div>

### **Παράδειγμα Εξόδου**

```txt
1 14
```

## **Επεξήγηση**

#### Δεδομένα Εισόδου:

<pre style="margin:10; padding:0;">
  <code style="padding:0; margin:0;">
  N = 2, M = 3, K = 2
  </code>
</pre>

<table>
  <tr>
    <td style="vertical-align:top; padding-right:12px;">
      <code>Layer[0]</code>
      <pre style="margin:6px 0 0 0;">⎡ 1  4 ⎤
⎣ 7  0 ⎦</pre>
    </td>
    <td style="vertical-align:top; padding-right:10px;">
      <code>Layer[1]</code>
      <pre style="margin:6px 0 0 0;">⎡ 3  2 ⎤
⎣ 5  1 ⎦</pre>
    </td>
    <td style="vertical-align:top;">
      <code>Layer[2]</code>
      <pre style="margin:6px 0 0 0;">⎡ 0  6 ⎤
⎣ 2  8 ⎦</pre>
    </td>
    <td style="vertical-align:top;">
      <code>TargetMatrix</code>
      <pre style="margin:6px 0 0 0;">⎡ 4  5 ⎤
⎣ 6  7 ⎦</pre>
    </td>
  </tr>
</table>

<table>
  <tr>
    <td style="vertical-align:top; padding-right:20px;">
      <code>Input[0]</code>
      <pre style="margin:6px 0 0 0;">⎡ 2  1 ⎤,  L = 0, R = 2
⎣ 0  2 ⎦</pre>
    </td>
    <td style="vertical-align:top;">
      <code>Input[1]</code>
      <pre style="margin:6px 0 0 0;">⎡ 3  3 ⎤,  L = 1, R = 1
⎣ 2  9 ⎦</pre>
    </td>
  </tr>
</table>

#### Επεξεργασμένες Εικόνες Εξόδου:

<pre style="margin:6px 0 0 0;"><code>OutputMatrix[0] = ⎡ 2  1 ⎤ + ⎡ 1  4 ⎤ - ⎡ 3  2 ⎤ + ⎡ 0  6 ⎤ = ⎡ 0  9 ⎤
                  ⎣ 0  2 ⎦   ⎣ 7  0 ⎦   ⎣ 5  1 ⎦   ⎣ 2  8 ⎦   ⎣ 4  9 ⎦

OutputMatrix[1] = ⎡ 3  3 ⎤ + ⎡ 3  2 ⎤ = ⎡ 6  5 ⎤
                  ⎣ 2  9 ⎦   ⎣ 5  1 ⎦   ⎣ 7 10 ⎦</code></pre>

#### Υπολογισμός Σφαλμάτων:

<pre style="margin:0px 0 0 0;">
<code> • Error[0] = (0−4)² + (9−5)² + (4−6)² + (9−7)² = 40
 • Error[1] = (6−4)² + (5−5)² + (7−6)² + (10−7)² = 14 </code>
</pre>

#### Συνεπώς,

Η θέση του σκίτσου με το μικρότερο σφάλμα είναι η **1**, και το σφάλμα του είναι **14**.